define(["block_xp/ui-commons-lazy"],(()=>(()=>{var deferred,leafPrototypes,getProto,__webpack_modules__={791:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{App:()=>App,dependencies:()=>dependencies,startApp:()=>startApp});var menu=__webpack_require__(929),react=__webpack_require__(540),react_dom=__webpack_require__(961),es=__webpack_require__(942);const makeAddonContextValueFromAppProps=props=>{var _props$addon;return{activated:!1,enablepromo:!0,promourl:"https://www.levelup.plus/xp/",...null!==(_props$addon=null==props?void 0:props.addon)&&void 0!==_props$addon?_props$addon:{}}},AddonContext=(0,react.createContext)({activated:!1,enablepromo:!0,promourl:"https://www.levelup.plus/xp/"}),utils_classNames=function(){for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++)args[_key]=arguments[_key];return args.filter(Boolean).join(" ")};const stripTags=html=>{var tmp=document.createElement("div");return tmp.innerHTML=html,tmp.textContent||tmp.innerText||""},escapeCharMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"},escapeHtml=text=>text.replace(/[&<>"']/g,(function(m){return escapeCharMap[m]})),M=window.M,modules={};function getString(id,component,a){return M.util.get_string(id,component,a)}function hasString(id,component){return void 0!==M.str[component]&&void 0!==M.str[component][id]}function getModule(name){return modules[name]}async function getModuleAsync(amd){return modules[amd]?modules[amd]:new Promise(((resolve,reject)=>{window.require([amd],(mod=>{modules[amd]=mod,resolve(mod)}),reject)}))}function imageUrl(name,component){return M.util.image_url(name,component)}let loadStringCache=function(){let maxItems=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128,items={},keys=[];const purge=()=>{if(keys.length>maxItems){const idx=Math.max(0,keys.length-maxItems);keys.slice(0,idx).forEach((key=>{delete items[key]})),keys=keys.slice(idx)}};return{set:(key,value)=>{items[key]=value,keys.push(key),purge()},get:key=>items[key]}}(64);async function loadString(id,component){const cacheKey="".concat(id,"/").concat(component);let promise=loadStringCache.get(cacheKey);if(!promise){promise=(await getModuleAsync("core/str")).get_string(id,component),loadStringCache.set(cacheKey,promise)}return await promise}async function loadStrings(ids,component){const cacheKey="".concat(ids.join(","),"/").concat(component);let promise=loadStringCache.get(cacheKey);if(!promise){promise=(await getModuleAsync("core/str")).get_strings(ids.map((id=>({key:id,component:component})))),loadStringCache.set(cacheKey,promise)}return await promise}const useAnchorButtonProps=onClick=>({href:"#",role:"button",...useRoleButtonListeners(onClick)}),useRoleButtonListeners=onClick=>({onClick:e=>{e.preventDefault(),onClick()},onKeyDown:e=>{" "!==e.key&&"Enter"!==e.key||(e.preventDefault(),onClick())}}),useUnloadCheck=isDirty=>{const str=hooks_useString("changesmadereallygoaway","core");(0,react.useEffect)((()=>{const fn=e=>{if(isDirty&&!M.cfg.behatsiterunning)return e.preventDefault(),e.returnValue=str,str};return window.addEventListener("beforeunload",fn),()=>{window.removeEventListener("beforeunload",fn)}}))},hooks_useString=function(id){let component=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block_xp",a=arguments.length>2?arguments[2]:void 0;const wasKnownAtMount=(0,react.useMemo)((()=>hasString(id,component)),[id,component]),[isLoaded,setLoaded]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{setLoaded(!1)}),[id,component]),(0,react.useEffect)((()=>{if(wasKnownAtMount||isLoaded)return;let cancelled=!1;return(async()=>{try{await loadString(id,component),cancelled||setLoaded(!0)}catch(err){}})(),()=>{cancelled=!0}})),hasString(id,component)?getString(id,component,a):"​"},useStrings=function(ids){let component=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"block_xp";const idsForKey=ids.join(","),allKnownAtMount=(0,react.useMemo)((()=>ids.every((id=>hasString(id,component)))),[idsForKey,component]),[isLoaded,setLoaded]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{setLoaded(!1)}),[idsForKey,component]),(0,react.useEffect)((()=>{if(allKnownAtMount||isLoaded)return;let cancelled=!1;return(async()=>{try{await loadStrings(ids,component),cancelled||setLoaded(!0)}catch(err){}})(),()=>{cancelled=!0}})),(id,a)=>hasString(id,component)?getString(id,component,a):"​"},IfAddonActivatedOrPromoEnabled=_ref=>{let{children:children}=_ref;const{activated:activated,enablepromo:enablepromo}=(0,react.useContext)(AddonContext);return activated||enablepromo?react.createElement(react.Fragment,null,children):null},AddonRequired=()=>{const{promourl:promourl}=(0,react.useContext)(AddonContext),getStr=useStrings(["xpplusrequired","unlockfeaturewithxpplus"]);return react.createElement("a",{href:"#",role:"button",onClick:e=>e.preventDefault(),"data-toggle":"popover","data-placement":"top","data-container":"body","data-content":getStr("unlockfeaturewithxpplus",promourl),"data-html":"true",className:"xp-py-1 xp-px-1.5 xp-normal-case xp-text-2xs xp-inline-block xp-bg-black xp-text-white xp-rounded xp-no-underline"},getStr("xpplusrequired"))},SaveCancelModal=_ref2=>{let{children:children,onClose:onClose,onSave:onSave,show:show,title:title,saveButtonText:saveButtonText,defaultHeight:defaultHeight,large:large,canSave:canSave=!0}=_ref2;const modalPromise=(0,react.useRef)(),modalRef=(0,react.useRef)(),isSavePermitted=function(){let msDelay=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;const ref=(0,react.useRef)();return(0,react.useCallback)((()=>!(ref.current&&ref.current>Date.now()-msDelay||(ref.current=Date.now(),0))),[])}(),{getModule:getModule}=(modules=>{const modulesPromise=(0,react.useRef)(),modulesRef=(0,react.useRef)(),[ready,setReady]=(0,react.useState)(!1);return(0,react.useEffect)((()=>{if(modulesRef.current)return;modulesPromise.current||(modulesPromise.current=Promise.all(modules.map((module=>getModuleAsync(module)))));let cancelled=!1;return modulesPromise.current.then((loadedModles=>{cancelled||(modulesRef.current=modules.reduce(((acc,module,i)=>(acc[module]=loadedModles[i],acc)),{}),setReady(!0))})),()=>{cancelled=!0}})),{getModule:(0,react.useCallback)((module=>{var _modulesRef$current$m;return modulesRef.current&&null!==(_modulesRef$current$m=modulesRef.current[module])&&void 0!==_modulesRef$current$m?_modulesRef$current$m:null}),[ready,modulesRef.current])}})(["core/modal_factory","core/modal_events"]),[ready,setReady]=(0,react.useState)(!1),getSaveButton=(0,react.useCallback)((()=>{if(!modalRef.current)return null;const node=modalRef.current.getFooter()[0].querySelector('[data-action="save"]');return null!=node?node:null}),[modalRef.current]),setSaveButtonText=text=>{const saveBtn=getSaveButton();saveBtn&&text&&(saveBtn.textContent=text)};return(0,react.useEffect)((()=>{let cancelled=!1;if(modalRef.current)return;const ModalFactory=getModule("core/modal_factory");return ModalFactory?(modalPromise.current||(modalPromise.current=ModalFactory.create({type:ModalFactory.types.SAVE_CANCEL,title:title,large:large,body:"<div class='block_xp' style='".concat(defaultHeight?"height: ".concat(defaultHeight,"px"):"","'></div>")})),modalPromise.current.then((modal=>{cancelled||(modalRef.current=modal,saveButtonText&&setSaveButtonText(saveButtonText),setReady(!0),show&&modal.show())})),()=>{cancelled=!0}):void 0})),(0,react.useEffect)((()=>{const modal=modalRef.current;if(!modal)return;const ModalEvents=getModule("core/modal_events");if(!ModalEvents)return;const root=modal.getRoot(),handleSave=e=>{isSavePermitted()&&onSave&&onSave(e)},handleClose=()=>{onClose&&onClose()},updateReactNodeHeight=()=>{const body=modal.getBody()[0],reactNode=body?body.querySelector(".block_xp"):null;if(!body||!reactNode)return;const height=body.clientHeight-(parseFloat(getComputedStyle(body).paddingTop)+parseFloat(getComputedStyle(body).paddingBottom));reactNode.style.height="".concat(height,"px")},attachResize=()=>{window.addEventListener("resize",updateReactNodeHeight)};return root.on(ModalEvents.save,handleSave),root.on(ModalEvents.hidden,handleClose),root.on(ModalEvents.shown,attachResize),()=>{root.off(ModalEvents.save,handleSave),root.off(ModalEvents.hidden,handleClose),root.off(ModalEvents.shown,attachResize),window.removeEventListener("resize",updateReactNodeHeight)}})),(0,react.useEffect)((()=>{modalRef.current&&(show?modalRef.current.show():modalRef.current.hide())}),[show,modalRef.current]),(0,react.useEffect)((()=>{modalRef.current&&title&&modalRef.current.setTitle(title)}),[title,modalRef.current]),(0,react.useEffect)((()=>{setSaveButtonText(saveButtonText)}),[saveButtonText,modalRef.current]),(0,react.useEffect)((()=>{((attr,value)=>{const saveBtn=getSaveButton();saveBtn&&attr&&(null==value||!1===value?saveBtn.removeAttribute(attr):saveBtn.setAttribute(attr,value))})("disabled",!canSave)}),[canSave,modalRef.current]),modalRef.current?react_dom.createPortal(children,modalRef.current.getBody()[0].querySelector(".block_xp")):null},components_Str=_ref5=>{let{id:id,component:component="block_xp",a:a}=_ref5;const str=hooks_useString(id,component,a);return react.createElement(react.Fragment,null,str||"​")},Select=_ref7=>{let{className:className="",...props}=_ref7;return react.createElement("select",{...props,className:"xp-m-0 xp-max-w-auto form-control ".concat(className)})},Textarea=_ref8=>{let{className:className="",...props}=_ref8;return react.createElement("textarea",{...props,className:"xp-m-0 form-control ".concat(className)})},components_Input=_ref6=>{let{className:className="",...props}=_ref6;return react.createElement("input",{...props,className:"xp-m-0 form-control ".concat(className)})},NumInput=_ref9=>{let{className:className,value:value,onChange:onChange,selectOnFocus:selectOnFocus,...props}=_ref9;const inputProps=((value,onChange)=>{const valueAsString=value.toString(),[externalValue,setExternalValue]=(0,react.useState)(valueAsString),[internalValue,setInternalValue]=(0,react.useState)(externalValue);return(0,react.useEffect)((()=>{valueAsString!==externalValue&&(setExternalValue(valueAsString),setInternalValue(valueAsString))})),{value:internalValue,onChange:e=>{setInternalValue(e.target.value.replace(/[^0-9]/,""))},onBlur:e=>{const v=parseInt(internalValue,10)||0;setExternalValue(v.toString()),onChange(v)}}})(value,onChange);return react.createElement(components_Input,{type:"text",...inputProps,className:className,onFocus:e=>{selectOnFocus&&e.currentTarget.select()},...props})},NumberInputWithButtons=_ref11=>{let{onChange:onChange,value:value,min:min,max:max,suffix:suffix,step:step=1,inputProps:inputProps}=_ref11;const hasMin=void 0!==min,hasMax=void 0!==max,minDisabled=hasMin&&min>=value,maxDisabled=hasMax&&max<=value,minusProps=useAnchorButtonProps((()=>{minDisabled||handleChange(value-step)})),plusProps=useAnchorButtonProps((()=>{maxDisabled||handleChange(value+step)})),handleChange=n=>{let final=n;hasMin&&(final=Math.max(min,final)),hasMax&&(final=Math.min(max,final)),onChange(final)},{className:inputClassName,...remainingInputProps}=null!=inputProps?inputProps:{},allInputProps={className:utils_classNames("xp-h-auto xp-border-0 xp-text-center xp-rounded-none focus:xp-z-10",suffix?"xp-pr-6":null,inputClassName||"xp-w-16"),...remainingInputProps};return react.createElement("div",{className:"xp-inline-flex xp-rounded xp-border xp-border-solid xp-border-gray-300"},react.createElement("a",{...minusProps,className:utils_classNames("xp-flex-0 xp-border-0 xp-border-gray-300 xp-border-solid xp-border-r xp-rounded-l xp-py-0.5 xp-px-1 xp-flex xp-items-center xp-justify-center","focus:xp-z-10",minDisabled?"xp-bg-gray-100 xp-cursor-pointer xp-text-gray-500":"xp-bg-white xp-text-inherit")},react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"xp-w-5 xp-h-5"},react.createElement("path",{fillRule:"evenodd",d:"M4 10a.75.75 0 01.75-.75h10.5a.75.75 0 010 1.5H4.75A.75.75 0 014 10z",clipRule:"evenodd"}))),react.createElement("div",{className:"xp-flex-1 xp-relative"},react.createElement(NumInput,{onChange:handleChange,value:value,...allInputProps}),suffix?react.createElement("div",{className:"xp-pointer-events-none xp-absolute xp-inset-y-0 xp-right-0 xp-flex xp-items-center xp-pr-2"},react.createElement("span",{className:"xp-text-gray-500"},suffix)):null),react.createElement("a",{...plusProps,className:utils_classNames("xp-flex-0 xp-border-0 xp-border-gray-300 xp-border-solid xp-border-l xp-rounded-r xp-py-0.5 xp-px-1 xp-flex xp-items-center xp-justify-center","focus:xp-z-10",maxDisabled?"xp-bg-gray-100 xp-cursor-pointer xp-text-gray-500":"xp-bg-white xp-text-inherit")},react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"xp-w-5 xp-h-5"},react.createElement("path",{d:"M10.75 4.75a.75.75 0 00-1.5 0v4.5h-4.5a.75.75 0 000 1.5h4.5v4.5a.75.75 0 001.5 0v-4.5h4.5a.75.75 0 000-1.5h-4.5v-4.5z"}))))},RadioGroup=_ref12=>{let{items:items,value:value,onChange:onChange}=_ref12;const[uniqid]=(0,react.useState)((()=>Math.random().toString(12).slice(2)));return react.createElement("div",{className:"xp-space-y-2"},items.map(((item,idx)=>react.createElement("label",{className:"xp-relative xp-flex xp-items-start xp-cursor-pointer xp-m-0 xp-font-normal",key:item.value},react.createElement("div",{className:"xp-h-6 xp-flex xp-items-center"},react.createElement("input",{type:"radio","aria-describedby":"xp-radiogroup-".concat(uniqid,"-").concat(idx),checked:value===item.value,onChange:()=>onChange(item.value)})),react.createElement("div",{className:"xp-ml-3"},react.createElement("div",{className:"xp-font-medium"},item.label),item.desc?react.createElement("p",{id:"xp-radiogroup-".concat(uniqid,"-").concat(idx),className:"xp-text-gray-500 xp-m-0"},item.desc):null)))))};function calculationMethodReducer(state,action){switch(action.type){case"setMethod":return{...state,method:action.payload};case"setBase":return{...state,base:Math.max(1,action.payload)};case"setIncrement":return{...state,incr:Math.max(0,action.payload)};case"setCoef":return{...state,coef:Math.min(5,Math.max(1,action.payload))}}return state}function getDefaultBulkEditPointsState(props){return{method:props.method||"relative",base:Math.max(1,props.base||120),incr:Math.max(0,props.incr||40),coef:Math.min(5,Math.max(props.coef||1.3))}}const BulkEditPoints=_ref13=>{let{method:method,base:base,incr:incr,coef:coef,onBaseChange:onBaseChange,onCoefChange:onCoefChange,onIncrementChange:onIncrementChange,onMethodChange:onMethodChange}=_ref13;const getStr=useStrings(["basepoints","basepointslineardesc","basepointsrelativedesc","difficulty","difficultyflat","difficultyflatdesc","difficultylinear","difficultylineardesc","difficultylinearincrdesc","difficultypointincrease","difficultyrelative","difficultyrelativedesc","difficultyrelativeincrdesc","documentation","pointsperlevel","recommended"],"block_xp");return react.createElement("div",{className:"xp-space-y-4"},react.createElement("div",null,react.createElement("div",{className:"xp-mb-2 xp-flex xp-items-start xp-flex-wrap"},react.createElement("div",{className:"xp-grow xp-font-bold"},getStr("difficulty")),react.createElement("div",{className:"xp-shrink-0"},react.createElement("a",{href:"https://docs.levelup.plus/xp/docs/levels",target:"_blank",rel:"noopener"},getStr("documentation")))),react.createElement(RadioGroup,{onChange:onMethodChange,value:method,items:[{value:"flat",label:getStr("difficultyflat"),desc:getStr("difficultyflatdesc")},{value:"linear",label:getStr("difficultylinear"),desc:getStr("difficultylineardesc")},{value:"relative",label:react.createElement(react.Fragment,null,getStr("difficultyrelative"),react.createElement("div",{className:"badge badge-info xp-ml-2"},getStr("recommended"))),desc:getStr("difficultyrelativedesc")}]})),react.createElement("div",null,react.createElement("p",{className:"xp-font-bold xp-mb-2"},react.createElement(components_Str,{id:"settings",component:"core"})),"flat"===method?react.createElement(react.Fragment,null,react.createElement("div",{className:""},react.createElement("label",{htmlFor:"xp-calc-bp",className:"xp-m-0"},react.createElement(components_Str,{id:"pointsperlevel"})),react.createElement("div",null,react.createElement(NumberInputWithButtons,{value:base,onChange:onBaseChange,min:1,step:10,inputProps:{id:"xp-calc-bp",className:"xp-w-24"}})))):null,"linear"===method?react.createElement(react.Fragment,null,react.createElement("div",{className:"xp-space-y-2"},react.createElement("div",{className:""},react.createElement("label",{htmlFor:"xp-calc-bp",className:"xp-m-0"},react.createElement(components_Str,{id:"basepoints"})),react.createElement("div",null,react.createElement(NumberInputWithButtons,{value:base,onChange:onBaseChange,min:1,step:10,inputProps:{id:"xp-calc-bp",className:"xp-w-24"}})),react.createElement("p",{className:"xp-text-gray-500 xp-m-0 xp-mt-1"},getStr("basepointslineardesc"))),react.createElement("div",{className:""},react.createElement("label",{htmlFor:"xp-calc-pi",className:"xp-m-0"},getStr("difficultypointincrease")),react.createElement("div",null,react.createElement(NumberInputWithButtons,{value:incr,onChange:onIncrementChange,min:0,inputProps:{id:"xp-calc-pi",className:"xp-w-24"}})),react.createElement("p",{className:"xp-text-gray-500 xp-m-0 xp-mt-1"},getStr("difficultylinearincrdesc"))))):null,"relative"===method?react.createElement(react.Fragment,null,react.createElement("div",{className:"xp-space-y-2"},react.createElement("div",{className:""},react.createElement("label",{htmlFor:"xp-calc-bp",className:"xp-m-0"},react.createElement(components_Str,{id:"basepoints"})),react.createElement("div",null,react.createElement(NumberInputWithButtons,{value:base,onChange:onBaseChange,min:1,step:10,inputProps:{id:"xp-calc-bp",className:"xp-w-24"}})),react.createElement("p",{className:"xp-text-gray-500 xp-m-0 xp-mt-1"},getStr("basepointsrelativedesc"))),react.createElement("div",{className:""},react.createElement("label",{htmlFor:"xp-calc-pi",className:"xp-m-0"},getStr("difficultypointincrease")),react.createElement("div",null,react.createElement(NumberInputWithButtons,{value:Math.floor(100*coef-100),onChange:p=>onCoefChange(1+p/100),min:0,max:400,inputProps:{id:"xp-calc-pi",className:"xp-w-24",maxLength:3},suffix:"%"})),react.createElement("p",{className:"xp-text-gray-500 xp-m-0 xp-mt-1"},getStr("difficultyrelativeincrdesc"))))):null))},BulkEditPointsModal=props=>{const[state,dispatch]=(0,react.useReducer)(calculationMethodReducer,props,getDefaultBulkEditPointsState),getStr=useStrings(["quickeditpoints","apply"],"block_xp");return react.createElement(SaveCancelModal,{show:props.show,onClose:()=>{dispatch({type:"reset",payload:getDefaultBulkEditPointsState(props)}),props.onClose&&props.onClose()},onSave:()=>{props.onSave&&props.onSave(state)},title:getStr("quickeditpoints"),saveButtonText:getStr("apply")},react.createElement(BulkEditPoints,{coef:state.coef,base:state.base,incr:state.incr,method:state.method,onBaseChange:p=>dispatch({type:"setBase",payload:p}),onCoefChange:p=>dispatch({type:"setCoef",payload:p}),onIncrementChange:p=>dispatch({type:"setIncrement",payload:p}),onMethodChange:p=>dispatch({type:"setMethod",payload:p})}))},components_Pix=_ref14=>{let{id:id,component:component="block_xp",className:className,alt:alt=""}=_ref14;return react.createElement("img",{src:imageUrl(id,component),alt:alt,className:className})},components_Spinner=_ref15=>{let{className:className}=_ref15;const alt=hooks_useString("loadinghelp","core");return react.createElement(components_Pix,{id:"y/loading",component:"core",className:className,alt:alt})},Button=_ref17=>{let{onClick:onClick,disabled:disabled,children:children,primary:primary,className:className,type:type="button"}=_ref17;const classes=utils_classNames("btn",primary?"btn-primary":"btn-default btn-secondary",className);return react.createElement("button",{className:classes,onClick:onClick,disabled:disabled,type:type},children)},SaveButton=_ref18=>{let{onClick:onClick,disabled:disabled,label:label,mutation:mutation={},statePosition:statePosition="after"}=_ref18;const getStr=useStrings(["changessaved","error"],"core"),{isLoading:isLoading,isSuccess:isSuccess,isError:isError}=mutation,isStateBefore="before"===statePosition,state=react.createElement("div",{className:"xp-w-8 xp-flex ".concat(isStateBefore?"xp-mr-4 xp-justify-end":"xp-ml-4"),"aria-live":"assertive"},isLoading?react.createElement(components_Spinner,null):null,isSuccess?react.createElement(components_Pix,{id:"i/valid",component:"core",alt:getStr("changessaved")}):null,isError?react.createElement(components_Pix,{id:"i/invalid",component:"core",alt:getStr("error")}):null);return react.createElement("div",{className:"xp-flex xp-items-center"},isStateBefore?state:null,react.createElement("div",{className:""},react.createElement(Button,{primary:!0,onClick:onClick,disabled:disabled||isLoading},label||react.createElement(components_Str,{id:"savechanges",component:"core"}))),isStateBefore?null:state)},AnchorButton=_ref19=>{let{children:children,onClick:onClick,className:className,...props}=_ref19;const anchorButtonProps=useAnchorButtonProps(onClick);return react.createElement("a",{className:utils_classNames("xp-text-inherit xp-no-underline",className),...props,...anchorButtonProps},children)};var esm=__webpack_require__(968);function Expandable(_ref20){let{expanded:expanded,children:children,id:id}=_ref20;return react.createElement(esm.A,{id:id,height:expanded?"auto":0,applyInlineTransitions:!1,animationStateClasses:{animating:"xp-transition-height xp-duration-500",static:"xp-transition-height xp-duration-500",animatingUp:"",animatingDown:"",animatingToHeightZero:"",animatingToHeightAuto:"",animatingToHeightSpecific:"",staticHeightZero:"",staticHeightAuto:"",staticHeightSpecific:""}},children)}const getLevelHtml=(level,small,medium)=>{const label=getString("levelx","block_xp",level.level),classes="block_xp-level level-".concat(level.level," ").concat(small?"small":medium?"medium":"");return level.badgeurl?'\n      <div class="'.concat(classes+" level-badge",'" aria-label="').concat(escapeHtml(label),'">\n        <img src="').concat(escapeHtml(level.badgeurl),'" alt="').concat(escapeHtml(label),'" />\n      </div>\n    '):'\n    <div class="'.concat(classes,'" aria-label="').concat(escapeHtml(label),'">\n      ').concat(level.level,"\n    </div>\n  ")},components_Level=(0,react.forwardRef)(((_ref26,ref)=>{let{level:level,small:small,medium:medium}=_ref26;const label=hooks_useString("levelx","block_xp",level.level),classes="block_xp-level level-"+level.level+(small?" small":medium?" medium":"");return level.badgeurl?react.createElement("div",{className:classes+" level-badge","aria-label":label,ref:ref},react.createElement("img",{src:level.badgeurl,alt:label})):react.createElement("div",{className:classes,"aria-label":label,ref:ref},level.level)})),Tooltip=_ref27=>{let{children:children,content:content}=_ref27;const ref=react.useRef(null);return(0,react.useEffect)((()=>{const $=getModule("jquery");if($&&ref.current&&$(ref.current).tooltip)return ref.current.setAttribute("data-container","body"),ref.current.setAttribute("title",content),$(ref.current).tooltip("enable"),()=>{if(ref.current&&$(ref.current).tooltip)try{$(ref.current).tooltip("dispose")}catch(e){try{$(ref.current).tooltip("destroy")}catch(e){}}}}),[content]),(0,react.cloneElement)(children,{ref:ref})};function computeRequiredPointsWithMethod(level,method){return level<=1?0:2===level?method.base:"relative"===method.method?function(level,base,coef){return level<=1?0:2==level?base:coef<=1?base*(level-1):Math.round(base*((1-Math.pow(coef,level-1))/(1-coef)))}(level,method.base,method.coef):"linear"===method.method?method.base*(level-1)+Array.from({length:level}).reduce(((carry,_,idx)=>carry+Math.max(0,idx-1)*method.incr),0):(level-1)*method.base}const getMinimumPointsForLevel=(levels,level)=>1!==level.level&&levels.length?getPreviousLevel(levels,level).xprequired+1:0,getPreviousLevel=(levels,level)=>levels[Math.max(levels.indexOf(level)-1,0)];const query_queryClient=new(__webpack_require__(98).E)({defaultOptions:{queries:{staleTime:6e4,onError:err=>getModule("core/notification").exception(err)},mutations:{onError:err=>getModule("core/notification").exception(err)}}});var BADGE_TYPE;!function(BADGE_TYPE){BADGE_TYPE[BADGE_TYPE.Site=1]="Site",BADGE_TYPE[BADGE_TYPE.Course=2]="Course"}(BADGE_TYPE||(BADGE_TYPE={}));const optionsStates=[{id:"name",Icon:_ref23=>{let{className:className}=_ref23;return react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:className},react.createElement("path",{fillRule:"evenodd",d:"M9 2.25a.75.75 0 01.75.75v1.506a49.38 49.38 0 015.343.371.75.75 0 11-.186 1.489c-.66-.083-1.323-.151-1.99-.206a18.67 18.67 0 01-2.969 6.323c.317.384.65.753.998 1.107a.75.75 0 11-1.07 1.052A18.902 18.902 0 019 13.687a18.823 18.823 0 01-5.656 4.482.75.75 0 11-.688-1.333 17.323 17.323 0 005.396-4.353A18.72 18.72 0 015.89 8.598a.75.75 0 011.388-.568A17.21 17.21 0 009 11.224a17.17 17.17 0 002.391-5.165 48.038 48.038 0 00-8.298.307.75.75 0 01-.186-1.489 49.159 49.159 0 015.343-.371V3A.75.75 0 019 2.25zM15.75 9a.75.75 0 01.68.433l5.25 11.25a.75.75 0 01-1.36.634l-1.198-2.567h-6.744l-1.198 2.567a.75.75 0 01-1.36-.634l5.25-11.25A.75.75 0 0115.75 9zm-2.672 8.25h5.344l-2.672-5.726-2.672 5.726z",clipRule:"evenodd"}))},yes:"hasname",no:"hasnoname",checker:level=>level.name&&level.name.trim().length>0},{id:"description",Icon:_ref21=>{let{className:className}=_ref21;return react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:className},react.createElement("path",{fillRule:"evenodd",d:"M3 6.75A.75.75 0 013.75 6h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 6.75zM3 12a.75.75 0 01.75-.75h16.5a.75.75 0 010 1.5H3.75A.75.75 0 013 12zm0 5.25a.75.75 0 01.75-.75H12a.75.75 0 010 1.5H3.75a.75.75 0 01-.75-.75z",clipRule:"evenodd"}))},yes:"hasdescription",no:"hasnodescription",checker:level=>level.description&&level.description.trim().length>0},{id:"popupmessage",Icon:_ref24=>{let{className:className}=_ref24;return react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:className},react.createElement("path",{d:"M3.478 2.405a.75.75 0 00-.926.94l2.432 7.905H13.5a.75.75 0 010 1.5H4.984l-2.432 7.905a.75.75 0 00.926.94 60.519 60.519 0 0018.445-8.986.75.75 0 000-1.218A60.517 60.517 0 003.478 2.405z"}))},yes:"haspopupmessage",no:"hasnopopupmessage",checker:level=>level.popupmessage&&level.popupmessage.trim().length>0},{id:"badgeaward",Icon:_ref22=>{let{className:className}=_ref22;return react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",className:className},react.createElement("path",{fillRule:"evenodd",d:"M8.603 3.799A4.49 4.49 0 0112 2.25c1.357 0 2.573.6 3.397 1.549a4.49 4.49 0 013.498 1.307 4.491 4.491 0 011.307 3.497A4.49 4.49 0 0121.75 12a4.49 4.49 0 01-1.549 3.397 4.491 4.491 0 01-1.307 3.497 4.491 4.491 0 01-3.497 1.307A4.49 4.49 0 0112 21.75a4.49 4.49 0 01-3.397-1.549 4.49 4.49 0 01-3.498-1.306 4.491 4.491 0 01-1.307-3.498A4.49 4.49 0 012.25 12c0-1.357.6-2.573 1.549-3.397a4.49 4.49 0 011.307-3.497 4.49 4.49 0 013.497-1.307zm7.007 6.387a.75.75 0 10-1.22-.872l-3.236 4.53L9.53 12.22a.75.75 0 00-1.06 1.06l2.25 2.25a.75.75 0 001.14-.094l3.75-5.25z",clipRule:"evenodd"}))},yes:"hasbadgeaward",no:"hasnobadgeaward",checker:level=>Boolean(level.badgeawardid)}],optionsStatesStringIds=optionsStates.map((o=>o.yes)).concat(optionsStates.map((o=>o.no))),getInitialState=_ref28=>{let{levelsInfo:levelsInfo}=_ref28;return{algo:{...levelsInfo.algo,method:levelsInfo.algo.method||"relative",incr:levelsInfo.algo.incr||30},levels:levelsInfo.levels.map((level=>({...level}))),nblevels:levelsInfo.levels.length,pendingSave:!1}},markPendingSave=state=>({...state,pendingSave:!0}),reducer=(state,_ref29)=>{let nextLevel,[action,payload]=_ref29;switch(action){case"bulkEdit":return markPendingSave({...state,algo:payload,levels:state.levels.map((level=>({...level,xprequired:computeRequiredPointsWithMethod(level.level,payload)})))});case"levelDescChange":return markPendingSave({...state,levels:state.levels.map((level=>level!==payload.level?level:{...level,description:stripTags(payload.desc)||null}))});case"levelNameChange":return markPendingSave({...state,levels:state.levels.map((level=>level!==payload.level?level:{...level,name:stripTags(payload.name)||null}))});case"levelBadgeAwardIdChange":return markPendingSave({...state,levels:state.levels.map((level=>level!==payload.level?level:{...level,badgeawardid:payload.badgeawardid||null}))});case"levelPopupMessageChange":return markPendingSave({...state,levels:state.levels.map((level=>level!==payload.level?level:{...level,popupmessage:payload.popupmessage||null}))});case"levelPointsChange":return nextLevel=function(levels,level){let highest=arguments.length>2&&void 0!==arguments[2]?arguments[2]:9999,index=Math.min(highest,Math.max(levels.indexOf(level)+1,0));return levels[index]}(state.levels,payload.level,state.nblevels),isNaN(payload.points)||payload.points<=2||payload.points>=1/0||payload.points<=getPreviousLevel(state.levels,payload.level).xprequired?state:markPendingSave((state=>({...state,levels:state.levels.reduce(((carry,level,i)=>carry.concat([{...level,xprequired:Math.max(level.xprequired,getMinimumPointsForLevel(carry.concat([level]),level))}])),[])}))({...state,levels:state.levels.map((level=>level!==payload.level?level:{...level,xprequired:payload.points}))}));case"nbLevelsChange":return void 0===(null==payload?void 0:payload.n)||isNaN(payload.n)||payload.n<2||payload.n>99?state:markPendingSave({...state,nblevels:payload.n,levels:state.levels.concat(Array.from({length:Math.max(0,payload.n-state.levels.length)}).map(((_,i)=>{const l=state.levels.length+i+1;return{level:l,name:null,description:null,badgeurl:((null==payload?void 0:payload.defaultBadgeUrls)||{})[l]||null,xprequired:computeRequiredPointsWithMethod(l,state.algo)}})))});case"markSaved":return{...state,pendingSave:!1}}return state},OptionField=_ref30=>{let{label:label,children:children,note:note,xpPlusRequired:xpPlusRequired}=_ref30;return react.createElement("div",null,react.createElement("label",{className:"xp-m-0 xp-block xp-font-normal"},react.createElement("div",{className:"xp-flex"},react.createElement("div",{className:"xp-grow xp-uppercase xp-text-xs"},label),react.createElement("div",null,xpPlusRequired?react.createElement(AddonRequired,null):null)),react.createElement("div",{className:"xp-mt-1"},children)),note?react.createElement("div",{className:"xp-text-gray-500 xp-mt-1"},note):null)},App=_ref31=>{let{courseId:courseId,levelsInfo:levelsInfo,resetToDefaultsUrl:resetToDefaultsUrl,defaultBadgeUrls:defaultBadgeUrls,badges:badges=[]}=_ref31;const hasXpPlus=(0,react.useContext)(AddonContext).activated,[state,dispatch]=(0,react.useReducer)(reducer,{levelsInfo:levelsInfo},getInitialState),levels=state.levels.slice(0,state.nblevels),[expanded,setExpanded]=react.useState([]),[bulkEdit,setBulkEdit]=react.useState(!1),getStr=useStrings(optionsStatesStringIds.concat(["levelssaved","unknownbadgea","levelx","previewpopupnotification"])),getBadgeStr=useStrings(["coursebadges","sitebadges"],"core_badges"),getCoreStr=useStrings(["other","none"],"core");useUnloadCheck(state.pendingSave);const mutation=(0,es.useMutation)((()=>async function(method,args){return(await getModuleAsync("core/ajax")).call([{methodname:method,args:args}])[0]}(courseId?"block_xp_set_levels_info":"block_xp_set_default_levels_info",{courseid:courseId||void 0,levels:levels.map((level=>{const{level:levelnum,xprequired:xprequired,...metadata}=level;return{level:levelnum,xprequired:xprequired,metadata:Object.entries(metadata).reduce(((carry,_ref32)=>{let[name,value]=_ref32;return carry.concat([{name:name,value:value}])}),[])}})),algo:state.algo})));(0,react.useEffect)((()=>{if(!mutation.isSuccess)return;const t=setTimeout((()=>{mutation.reset()}),2500);return()=>clearTimeout(t)}));const siteBadges=(0,react.useMemo)((()=>badges.filter((b=>b.type===BADGE_TYPE.Site)).sort(((a,b)=>a.name.localeCompare(b.name)))),[badges]),courseBadges=(0,react.useMemo)((()=>badges.filter((b=>b.type===BADGE_TYPE.Course)).sort(((a,b)=>a.name.localeCompare(b.name)))),[badges]),allExpanded=expanded.length===levels.length,handleSave=()=>{mutation.mutate(void 0,{onSuccess:()=>{const Toast=getModule("core/toast");Toast&&Toast.add(getStr("levelssaved")),dispatch(["markSaved",!0])}})},handleNumLevelsChange=n=>{dispatch(["nbLevelsChange",{n:n,defaultBadgeUrls:defaultBadgeUrls}])},handleXpChange=(level,xp)=>{level.xprequired!==xp&&dispatch(["levelPointsChange",{level:level,points:xp}])};return react.createElement("div",{className:"xp-flex xp-flex-col"},react.createElement("div",{className:"xp-mb-4 xp-flex xp-items-end xp-justify-end xp-flex-wrap xp-gap-4"},react.createElement("div",{className:"xp-flex xp-flex-1 xp-gap-4 xp-items-end xp-flex-wrap"},react.createElement("div",{className:""},react.createElement("label",{htmlFor:"label-x",className:"xp-block xp-m-0"},react.createElement(components_Str,{id:"numberoflevels"})),react.createElement(NumberInputWithButtons,{value:state.nblevels,onChange:handleNumLevelsChange,min:2,max:99,inputProps:{id:"label-x",maxLength:2}})),react.createElement("div",{className:""},react.createElement(Button,{onClick:()=>setBulkEdit(!0)},react.createElement(components_Str,{id:"quickeditpoints"})),react.createElement(BulkEditPointsModal,{show:bulkEdit,onClose:()=>setBulkEdit(!1),onSave:state=>{dispatch(["bulkEdit",state])},method:state.algo.method,coef:state.algo.coef,base:state.algo.base,incr:state.algo.incr}))),react.createElement("div",{className:"xp-flex xp-gap-1"},react.createElement(SaveButton,{statePosition:"before",onClick:handleSave,mutation:mutation,disabled:!state.pendingSave||mutation.isLoading}),react.createElement(menu.W,{as:"div",className:"xp-relative xp-inline-block xp-text-left"},react.createElement("div",null,react.createElement(menu.W.Button,{className:"xp-text-inherit xp-bg-transparent xp-border-0 xp-p-2 xp-flex xp-items-center xp-rounded-full hover:xp-bg-gray-100"},react.createElement("span",{className:"sr-only"},react.createElement(components_Str,{id:"options",component:"core"})),react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"xp-w-5 xp-h-5","aria-hidden":"true"},react.createElement("path",{d:"M10 3a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM10 8.5a1.5 1.5 0 110 3 1.5 1.5 0 010-3zM11.5 15.5a1.5 1.5 0 10-3 0 1.5 1.5 0 003 0z"})))),react.createElement(menu.W.Items,{className:"xp-absolute xp-right-0 xp-z-10 xp-mt-2 xp-w-56 xp-origin-top-right xp-rounded-md xp-bg-white xp-border xp-border-solid xp-border-gray-300 xp-shadow-sm xp-divide-y xp-divide-gray-100"},react.createElement("div",{className:"xp-py-1"},react.createElement(menu.W.Item,null,(_ref33=>{let{active:active,close:close}=_ref33;return react.createElement("a",{href:"#",role:"button",onClick:e=>{e.preventDefault(),setExpanded(allExpanded?[]:levels.map((l=>l.level))),close()},className:utils_classNames(active?"xp-bg-gray-100":null,"xp-text-inherit xp-block xp-px-6 xp-py-1 xp-no-underline")},allExpanded?react.createElement(components_Str,{id:"collapseall",component:"core"}):react.createElement(components_Str,{id:"expandall",component:"core"}))})),react.createElement(menu.W.Item,null,(_ref34=>{let{active:active,close:close}=_ref34;return react.createElement("a",{href:"https://docs.levelup.plus/xp/docs/levels",target:"_blank",rel:"noopener",className:utils_classNames(active?"xp-bg-gray-100":null,"xp-text-inherit xp-block xp-px-6 xp-py-1 xp-no-underline")},react.createElement(components_Str,{id:"documentation"}))}))),resetToDefaultsUrl?react.createElement("div",{className:"xp-py-1"},react.createElement(menu.W.Item,null,(_ref35=>{let{active:active,close:close}=_ref35;return react.createElement("a",{href:resetToDefaultsUrl,className:utils_classNames(active?"xp-bg-gray-100":null,"xp-text-red-600 xp-block xp-px-6 xp-py-1 xp-no-underline")},react.createElement(components_Str,{id:"resettodefaults"}))}))):null)))),react.createElement("div",{className:"xp-flex xp-flex-col xp-flex-1 xp-gap-4"},Array.from({length:state.nblevels}).map(((_,idx)=>{var _levelsInfo$levels$id,_level$badgeawardid;const level=levels[idx]||{level:idx+1,xprequired:0},prevLevel=levels[idx-1],nextLevel=levels[idx+1],pointsInLevel=nextLevel?nextLevel.xprequired-level.xprequired:0,isExpanded=expanded.includes(level.level);let optionStates=level.level<=1?optionsStates.filter((o=>["name","description",courseId?null:"badgeawardid"].includes(o.id))):optionsStates;optionStates=optionStates.concat(Array.from({length:Math.max(0,optionsStates.length-optionStates.length)}).map((_=>null)));const isBadgeValueMissing=(null===(_levelsInfo$levels$id=levelsInfo.levels[idx])||void 0===_levelsInfo$levels$id?void 0:_levelsInfo$levels$id.badgeawardid)&&!badges.find((b=>b.id===levelsInfo.levels[idx].badgeawardid));return react.createElement(react.Fragment,{key:"l".concat(level.level)},react.createElement("div",{className:"xp-relative xp-min-h-28 xp-rounded-lg xp-border xp-border-solid xp-border-gray-200 xp-p-3 xp-overflow-hidden"},react.createElement("div",{className:"xp-absolute xp--top-4 xp--left-8 xp-text-[10rem] xp-text-gray-50 xp-leading-none xp-pointer-events-none"},level.level),react.createElement("div",{className:"xp-flex xp-items-center xp-flex-grow xp-gap-4 sm:xp-gap-8 xp-flex-col sm:xp-flex-row xp-relative"},react.createElement("div",{className:"xp-flex-0"},react.createElement(Tooltip,{content:getStr("levelx",level.level)},react.createElement(components_Level,{level:level}))),react.createElement("div",{className:"xp-shrink-0 xp-basis-auto sm:xp-basis-52 sm:xp--mt-3.5"},react.createElement("div",{className:"xp-grid xp-grid-cols-2"},react.createElement("label",{className:"xp-m-0 xp-flex xp-items-end xp-text-xs xp-font-normal xp-uppercase",htmlFor:"xp-level-".concat(level.level,"-start")},react.createElement(components_Str,{id:"levelpointsstart"})),react.createElement("label",{className:"xp-m-0 xp-flex xp-items-end xp-text-xs xp-font-normal xp-uppercase",htmlFor:"xp-level-".concat(level.level,"-length")},react.createElement(components_Str,{id:"levelpointslength"}))),react.createElement("div",{className:"xp-grid xp-grid-cols-2 xp-border xp-border-solid xp-border-gray-300 xp-rounded"},react.createElement("div",null,react.createElement(NumInput,{value:level.xprequired,onChange:xp=>handleXpChange(level,xp),disabled:level.level<=1,className:"xp-h-full xp-min-w-[4ch] xp-w-full xp-rounded-none xp-rounded-l xp-border-0 xp-relative focus:xp-z-10",id:"xp-level-".concat(level.level,"-start")})),react.createElement("div",{className:""},react.createElement("div",{className:"xp-relative xp-w-full x-h-full"},react.createElement("div",{className:"xp-pointer-events-none xp-absolute xp-inset-y-0 xp-left-0 xp-flex xp-items-center xp-pl-2 xp-z-20"},react.createElement("span",{className:"xp-text-gray-500"},"+")),react.createElement(NumInput,{value:pointsInLevel,onChange:xp=>handleXpChange(nextLevel,level.xprequired+xp),disabled:pointsInLevel<=0,className:"xp-h-full xp-min-w-[4ch] xp-w-full xp-border-0 xp-rounded-none xp-border-l xp-border-gray-300 xp-rounded-r xp-pl-6 xp-relative focus:xp-z-10",id:"xp-level-".concat(level.level,"-length")}))))),react.createElement("div",{className:"xp-flex xp-grow xp-items-center xp-justify-center  xp-gap-4"},optionStates.map(((o,idx)=>{if(!o)return react.createElement("div",{key:idx,className:"xp-w-6 xp-h-6 xp-hidden sm:xp-block"});const state=o.checker(level),label=getStr(state?o.yes:o.no);return react.createElement(Tooltip,{content:label,key:idx},react.createElement("div",{className:utils_classNames("xp-w-6 xp-h-6",state?null:"xp-text-gray-300")},react.createElement("span",{className:"xp-sr-only"},label),react.createElement(o.Icon,{className:"xp-w-full xp-h-full"})))}))),react.createElement("div",{className:"xp-flex-0 sm:xp--mr-3"},react.createElement(AnchorButton,{"aria-expanded":isExpanded,"aria-controls":"xp-level-".concat(level.level,"-options"),onClick:()=>{setExpanded(isExpanded?expanded.filter((e=>e!=level.level)):[level.level,...expanded])},className:"xp-p-2 xp-inline-block sm:xp-mr-1"},react.createElement("span",{className:"xp-sr-only"},isExpanded?react.createElement(components_Str,{id:"collapse",component:"core"}):react.createElement(components_Str,{id:"expand",component:"core"})),react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:utils_classNames("xp-w-6 xp-h-6 xp-transition-transform xp-duration-300",isExpanded?"xp-rotate-90":null)},react.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"}))))),react.createElement(Expandable,{expanded:isExpanded,id:"xp-level-".concat(level.level,"-options")},react.createElement("div",{className:utils_classNames("sm:xp-ml-[100px] sm:xp-pl-8 xp-space-y-4")},react.createElement("div",{className:"xp-flex xp-items-end xp-gap-4"},react.createElement("div",{className:"xp-flex-1"},react.createElement(OptionField,{label:react.createElement(components_Str,{id:"name"})},react.createElement(components_Input,{className:"xp-min-w-48 x-w-full sm:xp-w-2/3 xp-max-w-full",onBlur:e=>((level,name)=>{level.name!==name&&dispatch(["levelNameChange",{level:level,name:name}])})(level,e.target.value),defaultValue:level.name||"",maxLength:40,type:"text"}))),prevLevel?react.createElement("div",{className:"xp-mb-1.5 xp-h-6 xp-w-6"},react.createElement(Tooltip,{content:getStr("previewpopupnotification")},react.createElement("div",null,react.createElement(AnchorButton,{onClick:()=>(async(level,prevLevel)=>{(await getModuleAsync("block_xp/popup-notification")).show({courseid:0,levelnum:level.level,levelname:level.name,levelbadge:getLevelHtml(level),prevlevelbadge:getLevelHtml(prevLevel),message:level.popupmessage})})(level,prevLevel)},react.createElement("span",{className:"xp-sr-only"},getStr("previewpopupnotification")),react.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"xp-w-6 xp-h-6"},react.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 8.25v-1.5m0 1.5c-1.355 0-2.697.056-4.024.166C6.845 8.51 6 9.473 6 10.608v2.513m6-4.871c1.355 0 2.697.056 4.024.166C17.155 8.51 18 9.473 18 10.608v2.513M15 8.25v-1.5m-6 1.5v-1.5m12 9.75-1.5.75a3.354 3.354 0 0 1-3 0 3.354 3.354 0 0 0-3 0 3.354 3.354 0 0 1-3 0 3.354 3.354 0 0 0-3 0 3.354 3.354 0 0 1-3 0L3 16.5m15-3.379a48.474 48.474 0 0 0-6-.371c-2.032 0-4.034.126-6 .371m12 0c.39.049.777.102 1.163.16 1.07.16 1.837 1.094 1.837 2.175v5.169c0 .621-.504 1.125-1.125 1.125H4.125A1.125 1.125 0 0 1 3 20.625v-5.17c0-1.08.768-2.014 1.837-2.174A47.78 47.78 0 0 1 6 13.12M12.265 3.11a.375.375 0 1 1-.53 0L12 2.845l.265.265Zm-3 0a.375.375 0 1 1-.53 0L9 2.845l.265.265Zm6 0a.375.375 0 1 1-.53 0L15 2.845l.265.265Z"})))))):null),react.createElement(OptionField,{label:react.createElement(components_Str,{id:"description"}),note:react.createElement(components_Str,{id:"leveldescriptiondesc"})},react.createElement(Textarea,{className:"xp-w-full",onBlur:e=>((level,desc)=>{level.description!==desc&&dispatch(["levelDescChange",{level:level,desc:desc}])})(level,e.target.value),defaultValue:level.description||"",maxLength:280,rows:2})),react.createElement(IfAddonActivatedOrPromoEnabled,null,level.level>1?react.createElement(react.Fragment,null,react.createElement(OptionField,{label:react.createElement(components_Str,{id:"popupnotificationmessage"}),note:react.createElement(components_Str,{id:"popupnotificationmessagedesc"}),xpPlusRequired:!hasXpPlus},react.createElement(Textarea,{className:"xp-w-full",onBlur:e=>{dispatch(["levelPopupMessageChange",{level:level,popupmessage:e.target.value}])},defaultValue:level.popupmessage||"",maxLength:280,rows:2,disabled:!hasXpPlus})),react.createElement(OptionField,{label:react.createElement(components_Str,{id:"badgeaward"}),note:react.createElement(components_Str,{id:"badgeawarddesc"}),xpPlusRequired:!hasXpPlus},courseId?react.createElement(Select,{disabled:!hasXpPlus,className:"xp-max-w-full xp-w-auto",value:null!==(_level$badgeawardid=level.badgeawardid)&&void 0!==_level$badgeawardid?_level$badgeawardid:"",onChange:e=>{dispatch(["levelBadgeAwardIdChange",{level:level,badgeawardid:parseInt(e.target.value,10)||null}])}},react.createElement("option",null,getCoreStr("none")),courseBadges.length?react.createElement("optgroup",{label:getBadgeStr("coursebadges")},courseBadges.map((b=>react.createElement("option",{value:b.id,key:b.id},b.name)))):null,siteBadges.length?react.createElement("optgroup",{label:getBadgeStr("sitebadges")},siteBadges.map((b=>react.createElement("option",{value:b.id,key:b.id},b.name)))):null,isBadgeValueMissing?react.createElement("optgroup",{label:getCoreStr("other")},react.createElement("option",{value:level.badgeawardid||""},getStr("unknownbadgea",level.badgeawardid))):null):react.createElement("div",{className:"alert alert-info xp-m-0"},react.createElement(components_Str,{id:"cannotbesetindefaults"})))):react.createElement("div",null,react.createElement("div",{className:"xp-text-sm xp-text-gray-500 xp-italic"},react.createElement(components_Str,{id:"levelupoptionsunavailableforlevelone"}))))))))}))),react.createElement("div",{className:"xp-flex xp-flex-1 xp-gap-4 xp-items-start xp-flex-wrap xp-mt-4"},react.createElement("div",{className:"xp-grow"},react.createElement(Button,{onClick:()=>handleNumLevelsChange(state.nblevels+1)},react.createElement(components_Str,{id:"addlevel"}))),react.createElement("div",{className:""},react.createElement(SaveButton,{statePosition:"before",onClick:handleSave,mutation:mutation,disabled:!state.pendingSave||mutation.isLoading}))))};function startApp(node,props){react_dom.render(react.createElement(AddonContext.Provider,{value:makeAddonContextValueFromAppProps(props)},react.createElement(es.QueryClientProvider,{client:query_queryClient},react.createElement(App,{...props}))),node)}const dependencies=(names=>{let optional=[];const list=names.map((name=>{const isOptional="?"===name.charAt(0),module=isOptional?name.substring(1):name;return isOptional&&optional.push(module),module}));return{list:list,optional:optional,loader:mods=>{mods.forEach(((mod,i)=>{!function(name,mod){modules[name]=mod}(list[i],mod)}))}}})(["core/notification","core/aria","?core/toast","jquery"])}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}__webpack_require__.m=__webpack_modules__,deferred=[],__webpack_require__.O=(result,chunkIds,fn,priority)=>{if(!chunkIds){var notFulfilled=1/0;for(i=0;i<deferred.length;i++){for(var[chunkIds,fn,priority]=deferred[i],fulfilled=!0,j=0;j<chunkIds.length;j++)(!1&priority||notFulfilled>=priority)&&Object.keys(__webpack_require__.O).every((key=>__webpack_require__.O[key](chunkIds[j])))?chunkIds.splice(j--,1):(fulfilled=!1,priority<notFulfilled&&(notFulfilled=priority));if(fulfilled){deferred.splice(i--,1);var r=fn();void 0!==r&&(result=r)}}return result}priority=priority||0;for(var i=deferred.length;i>0&&deferred[i-1][2]>priority;i--)deferred[i]=deferred[i-1];deferred[i]=[chunkIds,fn,priority]},__webpack_require__.n=module=>{var getter=module&&module.__esModule?()=>module.default:()=>module;return __webpack_require__.d(getter,{a:getter}),getter},getProto=Object.getPrototypeOf?obj=>Object.getPrototypeOf(obj):obj=>obj.__proto__,__webpack_require__.t=function(value,mode){if(1&mode&&(value=this(value)),8&mode)return value;if("object"==typeof value&&value){if(4&mode&&value.__esModule)return value;if(16&mode&&"function"==typeof value.then)return value}var ns=Object.create(null);__webpack_require__.r(ns);var def={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var current=2&mode&&value;"object"==typeof current&&!~leafPrototypes.indexOf(current);current=getProto(current))Object.getOwnPropertyNames(current).forEach((key=>def[key]=()=>value[key]));return def.default=()=>value,__webpack_require__.d(ns,def),ns},__webpack_require__.d=(exports,definition)=>{for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=(obj,prop)=>Object.prototype.hasOwnProperty.call(obj,prop),__webpack_require__.r=exports=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.j=251,(()=>{var installedChunks={251:0};__webpack_require__.O.j=chunkId=>0===installedChunks[chunkId];var webpackJsonpCallback=(parentChunkLoadingFunction,data)=>{var moduleId,chunkId,[chunkIds,moreModules,runtime]=data,i=0;if(chunkIds.some((id=>0!==installedChunks[id]))){for(moduleId in moreModules)__webpack_require__.o(moreModules,moduleId)&&(__webpack_require__.m[moduleId]=moreModules[moduleId]);if(runtime)var result=runtime(__webpack_require__)}for(parentChunkLoadingFunction&&parentChunkLoadingFunction(data);i<chunkIds.length;i++)chunkId=chunkIds[i],__webpack_require__.o(installedChunks,chunkId)&&installedChunks[chunkId]&&installedChunks[chunkId][0](),installedChunks[chunkId]=0;return __webpack_require__.O(result)},chunkLoadingGlobal=globalThis.webpackChunkblock_xp=globalThis.webpackChunkblock_xp||[];chunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null,0)),chunkLoadingGlobal.push=webpackJsonpCallback.bind(null,chunkLoadingGlobal.push.bind(chunkLoadingGlobal))})();var __webpack_exports__=__webpack_require__.O(void 0,[224],(()=>__webpack_require__(791)));return __webpack_exports__=__webpack_require__.O(__webpack_exports__)})()));

//# sourceMappingURL=ui-levels-lazy.min.js.map