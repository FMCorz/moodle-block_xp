/**
 * Notification popup queue.
 *
 * @copyright  2022 Frédéric Massart
 * @author     Frédéric Massart <fred@branchup.tech>
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("block_xp/popup-notification-queue",["block_xp/popup-notification","core/ajax"],(function(PopupNotification,Ajax){let instances=[],isShowing=!1;function notifyNewInstance(){isShowing||showNextInstance()}function showNextInstance(){if(!instances.length)return;isShowing=!0;const instance=instances.splice(0,1)[0];PopupNotification.show(instance,{onShown:()=>{Ajax.call([{methodname:"block_xp_mark_popup_notification_seen",args:{courseid:instance.courseid,level:instance.levelnum}}])[0].fail((function(){}))},onDismissed:()=>{isShowing=!1,setTimeout((()=>showNextInstance()),300)}})}function queue(additionalInstances){instances=instances.concat(additionalInstances),notifyNewInstance()}return{queue:queue,queueFromJson:selector=>{try{const node=document.querySelector(selector),data=node?JSON.parse(node.textContent):null;if(!Array.isArray(data))throw new Error("That's a bit strange.");queue(data)}catch(err){}}}}));

//# sourceMappingURL=popup-notification-queue.min.js.map